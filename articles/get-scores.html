<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Understanding the getScore Function Input • pandemonium</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Understanding the getScore Function Input">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pandemonium</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datainput.html">Data Input for pandemonium</a></li>
    <li><a class="dropdown-item" href="../articles/analysis-pages.html">Using the Data Analysis Page</a></li>
    <li><a class="dropdown-item" href="../articles/dim-reduction.html">Understanding the dimReduction Function Input</a></li>
    <li><a class="dropdown-item" href="../articles/get-coords.html">Understanding the getCoords Function Input</a></li>
    <li><a class="dropdown-item" href="../articles/get-scores.html">Understanding the getScore Function Input</a></li>
    <li><a class="dropdown-item" href="../articles/make-plots.html">How to Use makePlots</a></li>
    <li><a class="dropdown-item" href="../articles/output.html">How to Use writeResults</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Understanding the getScore Function Input</h1>
            
      

      <div class="d-none name"><code>get-scores.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette describes the usage of the <code>getScore</code>
parameter in the <code>pandemonium</code> app.</p>
<p>This is an input for a function that calculates scores and bins which
will be plotted in the input panel and can be used as colouring in
dimension reduction and tour views.</p>
<p>The <code>pandemonium</code> package provides two functions for
scores or one can be created and passed. The two functions provided
are:</p>
<ul>
<li>
<code>chi2score</code> This will calculate chi-squared values from
the <code>exp</code> reference point in space1. The scores returned are
chi-squared values, the bins are sigma bins from the reference point and
the interesting points are ‘bf’, the best fit and ‘sm’, the closet point
to the origin.</li>
<li>
<code>outsidescore</code> This function takes a set of scores for
each point and a name for the score from data outside the app. It is
passed when loading the app. the scores returned are the scores passed
to it, the bins are quartile bins of that score and no interesting
points are returned.</li>
</ul>
</div>
<div class="section level2">
<h2 id="writing-a-getscore-function">Writing a getScore function<a class="anchor" aria-label="anchor" href="#writing-a-getscore-function"></a>
</h2>
<div class="section level3">
<h3 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h3>
<p>The app will pass the following objects to getScore that may be used
in calculations:</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th>Input</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>space1</code></td>
<td>Data frame of space 1 values</td>
</tr>
<tr class="even">
<td><code>cov</code></td>
<td>Covariance matrix of space 1</td>
</tr>
<tr class="odd">
<td><code>covinv</code></td>
<td>Inverse covariance matrix of space 1</td>
</tr>
<tr class="even">
<td><code>exp</code></td>
<td>reference point in space 1</td>
</tr>
<tr class="odd">
<td><code>space2</code></td>
<td>Data frame of space 2 values</td>
</tr>
<tr class="even">
<td><code>space2.cov</code></td>
<td>Covariance matrix of space 2</td>
</tr>
<tr class="odd">
<td><code>space2.exp</code></td>
<td>reference point in space 2</td>
</tr>
<tr class="even">
<td><code>k</code></td>
<td>number of clusters being made can be used to set number of bins</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>The function should return a named list with some of the following
entries to be used by the app.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th>Output</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>score</code></td>
<td>This should be a vector of length = number of rows in space 1, the
values should be numeric</td>
</tr>
<tr class="even">
<td><code>scoreName</code></td>
<td>A name for the title of the score plot</td>
</tr>
<tr class="odd">
<td><code>bins</code></td>
<td>This should be a factor vector with length = number of rows in space
1</td>
</tr>
<tr class="even">
<td><code>binName</code></td>
<td>A name for the title of the bin plot</td>
</tr>
<tr class="odd">
<td><code>interest</code></td>
<td>A vector of names of interesting points to display in the hover of
<code>htmlwidgets</code> plots</td>
</tr>
<tr class="even">
<td><code>is.interest</code></td>
<td>A logical vector of interesting points to display in
<code>ggplot</code> plots</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>A simple template for what a <code>getScore</code> function should
look like is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myScore</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">space1</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">space1</span>, <span class="va">cov</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">cov1</span>, <span class="va">covinv</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">covInv1</span>,</span>
<span>                    <span class="va">exp</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">exp</span>, <span class="va">space2</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">space2</span>, <span class="va">space2.cov</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">cov2</span>,</span>
<span>                    <span class="va">space2.exp</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">space2.exp</span>, <span class="va">k</span> <span class="op">=</span> <span class="va">rv</span><span class="op">$</span><span class="va">kC</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## Calculations</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">space1</span><span class="op">)</span></span>
<span>  <span class="va">scores</span> <span class="op">&lt;-</span> <span class="co"># function to calculate scores</span></span>
<span>    <span class="va">bins</span> <span class="op">&lt;-</span> <span class="co"># function to bin scores</span></span>
<span></span>
<span>    <span class="co">## Return</span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">scores</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">scoreName</span> <span class="op">&lt;-</span> <span class="st">"scores"</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">bins</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">binName</span> <span class="op">&lt;-</span> <span class="st">"bins"</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">ret</span><span class="op">$</span><span class="va">is.interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ret</span><span class="op">$</span><span class="va">interest</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">ret</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pandemonium.html">pandemonium</a></span><span class="op">(</span><span class="va">df</span>, getScore <span class="op">=</span> <span class="va">myScore</span><span class="op">)</span></span></code></pre></div>
<p>For the function to take values from outside the app, it is best to
write it as a closure and pass these values when calling the app. This
has been done for <code>outsidescore</code> as seen below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outsideScore</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">scores</span>, <span class="va">scoreName</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">space1</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">space1</span><span class="op">)</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">scores</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">scores</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">scores</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="st">"inner"</span>, <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">is.interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ret</span><span class="op">$</span><span class="va">interest</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">scoreName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">scoreName</span><span class="op">)</span></span>
<span>    <span class="va">ret</span><span class="op">$</span><span class="va">binName</span> <span class="op">&lt;-</span> <span class="st">"quartile"</span></span>
<span>    <span class="va">ret</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pandemonium.html">pandemonium</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">Bikes</span><span class="op">$</span><span class="va">space1</span>, space2 <span class="op">=</span> <span class="va">Bikes</span><span class="op">$</span><span class="va">space2</span>,</span>
<span>  getScore <span class="op">=</span> <span class="fu">outsideScore</span><span class="op">(</span><span class="va">Bikes</span><span class="op">$</span><span class="va">other</span><span class="op">$</span><span class="va">res</span>, <span class="st">"Residual"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel McCoy, Ursula Laa, German Valencia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
